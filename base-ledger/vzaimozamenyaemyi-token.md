# Взаимозаменяемый токен

Предикат валидности взаимозаменяемых токенов разрешает изменение баланса токенов на основе сохранения запасов и одобрения отправителя. В Namada реализован предикат валидности "мультитокена", т.е. все токены имеют одинаковую логику и могут использовать один VP (с соответствующими различиями в хранении).

Баланс токена хранится с помощью ключа хранения. Ключ баланса токена должен иметь вид `#Multitoken/{token_addr}/balance/{owner_addr}`. Эти ключи могут быть сделаны с помощью функций токенов.

Мы можем иметь несколько балансов токенов для одного владельца по `{token_addr}`, например, токен, полученный по IBC, управляется в `#Multitoken/{ibc_token}/balance/{receiver_addr}`. Он отличается от исходного баланса получателя в `#Multitoken/{token_addr}/balance/{receiver_addr}`, чтобы знать, из какой цепочки был передан токен. Описание `{ibc_token}` приведено в разделе IBC.

Допускаются переводы между балансами с одинаковым `{token_addr}`. В частности, мы можем передать токен с `#Multitoken/{token_addr}/balance/{sender_addr}` на `#Multitoken/{token_addr}/balance/{receiver_addr}`.

Эти изменения баланса проверяются предикатом валидности мультитокена. Он также проверяет, отчеканен или сгорел токен. Если токен майнится или сжигается, т.е. когда в транзакции обновляется `#Multitoken/{token_addr}/balance/minted`, проверяется не только общий баланс майнинга, но и вызов предиката валидности майнера. Майнер должен быть установлен в транзакции, майнящей токен. Например, при получении токена по IBC полученный токен будет майниться для баланса получателя `#Multitoken/{ibc_token}/balance/{receiver_addr}`. Отчеканенный баланс `#Multitoken/{ibc_token}/balance/minted` также увеличивается на сумму полученного токена. Отчеканенная сумма должна быть проверена предикатом валидности мультитокена. Причем предикат валидности мультитокена проверяет, будет ли вызван предикат валидности майнера, в данном случае предикат валидности IBC (предикат валидности IBC проверяет правильность отчеканенной суммы для соответствующей операции IBC).
